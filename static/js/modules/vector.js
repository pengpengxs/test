_jsload2&&_jsload2('vector', 'w.extend(Lc.prototype,{pa:function(a,b){Ec.prototype.pa.call(this,a,b);this.Bg={};this.Uq(a);this.hq();this.Dq()},remove:function(){var a=this.B;Ec.prototype.remove.call(this);a&&(a.removeEventListener("zoomend",this.Tk),a.removeEventListener("moveend",this.xk),a.removeEventListener("resize",this.Ek),a.removeEventListener("hotspotclick",this.xL),a.Yl(this.k.wk))},Uq:function(a){this.B=a;this.vB=this.Ob;this.wc=this.B.D.devicePixelRatio;this.dn=62;a.Yl(this.k.wk);for(var b in this.bp)delete this.bp[b]}, hq:function(){var a=this,b=this.B;a.Tk=function(b){a.Dq(b)};a.xk=function(b){a.Dq(b)};a.Ek=function(b){a.Dq(b)};a.xL=function(b){0<b.spots.length&&a.zT(b.spots[0].getUserData().uid)};b.addEventListener("zoomend",a.Tk);b.addEventListener("moveend",a.xk);b.addEventListener("resize",a.Ek);b.addEventListener("hotspotclick",a.xL)},zT:function(a){var b=this,c=(1E5*Math.random()).toFixed(0);!z._rd&&(z._rd={});z._rd["_cbk"+c]=function(a){b.IQ(a);delete z._rd["_cbk"+c]};var d=b.JV;this.k.dh&&(d=b.KV);a=d+ a+"?scope=2&ak="+this.k.Ol+"&callback=BMap._rd._cbk"+c;this.k.dh&&(a+="&geotable_id="+this.k.dh);Qb(a)},IQ:function(a){var b=a.content;this.k.dh&&(b=a.contents[0]);if(a&&0==a.status&&b){var a={poiId:b.uid||"",databoxId:b.databox_id||"",title:this.k.dh?b.title:b.name,address:this.k.dh?b.address:b.addr,phoneNumber:b.tel||"",postcode:b.zip||"",provinceCode:1*b.province_id||-1,province:b.province||"",cityCode:1*b.city_id||-1,city:b.city||"",districtCode:1*b.district_id||-1,district:b.district||"",point:this.k.dh? new H(b.location[0],b.location[1]):new H(b.longitude,b.latitude),tags:b.tag&&b.tag.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,"").split(/\\s+/),typeId:1*b.cla||-1,extendedData:b.ext||{}},c=new N("onhotspotclick");c.customPoi=a;c.content=b;this.Ay&&this.Ay.dispatchEvent(c);this.dispatchEvent(c)}},Dq:function(){var a=this.B,b=a.ea(),c=a.ab.tm(this.vB,"yun",this.dn);if(a.Tb()){this.Dm||(this.Dm=o,0<c.length&&(this.Nb=a.na().k.Nb));this.Um=Math.pow(2,18-b);this.qh=c.length;a=0;for(b=c.length;a<b;a++)this.kr(c[a][0], c[a][1],c[a][2])}},kr:function(a,b,c){var d=this,e=d.map,f=e.Ia(),g=new H(f.lng,f.lat),i=e.ea(),e=Oc[Math.abs(a+b)%Oc.length]+"/data?grids="+a+"_"+b+"_"+i+"&q="+this.k.Yx+"&tags="+this.k.Wt+"&filter="+this.k.filter+"&sortby="+this.k.uy+"&ak="+this.k.Ol+"&age="+this.k.fw,e=this.k.dh?e+("&geotable_id="+this.k.dh):e+("&databox_id="+this.k.fK);c.Xe=q;Qb(e,function(e){var e=0==e.status?e.content[0].data:[],f=d.map,m=f.Ia(),f=f.ea();m.lb(g)&&f==i&&(d.Kn(e,c,a,b,i),d.qh--,0==d.qh&&d.Ay.dispatchEvent("oncustomlayerloaded"))})}, Kn:function(a,b,c,d,e){var f=b.getContext("2d");1<this.wc&&!b.lg&&(f.scale(this.wc,this.wc),b.lg=o);b.uB||(b.uB=o,f.translate(this.dn/2,this.dn/2));for(var e="hotSpotTile_"+c+"_"+d+"_"+e,g=0,i=a.length;g<i;g++)this.ZV(f,a[g],c,d,e,b)},ZV:function(a,b,c,d,e,f){var g=this,i=b[0],k=b[1],l=b[2],m=b[3],g=this,n=this.Nb,b=this.Um,c=c*b*n,d=(d+1)*b*n;/^POINT\\((.*)\\)$/.test(l);var l=RegExp.$1.split(","),u=l[0],v=l[1],x=(u-c)/b,y=(d-v)/b,C=new Image;C.onload=function(){var b=this.width,c=this.height;a.drawImage(this, x-b/2,y-c);g.bp[e]||(b={userData:{name:i,uid:k},offsets:[c,b/2,0,b/2]},b=new eb(Q.Cb(new H(u,v)),b),g.B.aw(b,g.k.wk));setTimeout(function(){g.bp[e]=o;f.Xe=o},1E3);delete this.onload};this.mX(m,function(a){""==m&&(m="sid1");C.src=a&&a.content&&a.content[m]&&""!=a.content[m]?"data:image/png;base64,"+a.content[m]:E.oa+"madian.png"})},n3:function(){if(this.Ob){for(var a=this.Ob,b=0,c=a.childNodes.length;b<c;b++)a.childNodes[b].Xe=q;this.B.Yl(this.k.wk);for(var d in this.bp)delete this.bp[d];this.Dq()}}, mX:function(a,b){var c=this,d=this.k.fK,e=this.k.XZ,f=this.k.Ol;""==a&&(a="sid1");if(this.Bg[a]&&this.Bg[a].data)b(this.Bg[a].data);else{this.Bg[a]||(this.Bg[a]={},this.Bg[a].NB=[]);this.Bg[a].NB.push(b);var g=z.Ec+"style/poi/rangestyle?method=getstyle";this.k.dh&&(d=this.k.dh);g+="&databox="+d+"&sid="+a+"&ak="+f;e&&(g+="&self_id="+e);this.Bg[a].WX||(setTimeout(function(){Qb(g,function(b){var d=c.Bg[a].NB;c.Bg[a].data=b;for(var e=0;e<d.length;e++)d[e](b);c.Bg[a].NB.length=0})},10),c.Bg[a].WX=o)}}});w.extend(Mc.prototype,{pa:function(a,b){Ec.prototype.pa.call(this,a,b);this.Uq(a);this.hq();this.Ou()},remove:function(){var a=this.B;Ec.prototype.remove.call(this);a.removeEventListener("zoomend",this.Tk);a.removeEventListener("moveend",this.xk);a.removeEventListener("resize",this.Ek)},Uq:function(a){this.B=a;this.vB=this.Ob;this.wc=this.B.D.devicePixelRatio;this.dn=0},hq:function(){var a=this,b=this.B;a.Tk=function(b){a.Ou(b)};a.xk=function(b){a.Ou(b)};a.Ek=function(b){a.Ou(b)};b.addEventListener("zoomend", a.Tk);b.addEventListener("moveend",a.xk);b.addEventListener("resize",a.Ek)},Ou:function(){var a=this.B,b=a.ab.tm(this.vB,"traffic",this.dn);this.Dm||(this.Dm=o,0<b.length&&(this.Nb=a.na().k.Nb));for(var a=0,c=b.length;a<c;a++)this.kr(b[a][0],b[a][1],b[a][2])},kr:function(a,b,c){var d=this,e=d.map,f=e.Ia(),g=new H(f.lng,f.lat),i=e.ea(),k="_t"+parseInt(a+""+b+""+i).toString(36),e=this.t_+"&x="+a+"&y="+b+"&z="+i+"&fn=BMap."+k+"&t="+(new Date).getTime();c.Xe=q;z[k]=function(e){var f=d.map,n=f.Ia(),f= f.ea();n.lb(g)&&f==i&&e.content&&e.content.tf&&d.Kn(e.content.tf,c,a,b);delete z[k]};Qb(e,q)},Kn:function(a,b){var c=b.getContext("2d"),d=this.oe,e=this.Yw,f=this.Zw;1<this.wc&&!b.lg&&(c.scale(this.wc,this.wc),b.lg=o);b.uB||(b.uB=o,c.translate(this.dn/2,this.dn/2));for(var g=0,i=a.length;g<i;g++){var k=a[g],l=k[1],m=this.Bb[k[3]],k=this.Bb[k[4]],n=l[0]/10,u=l[1]/10;c.beginPath();c.moveTo(n,u);for(var v=2,x=l.length;v<x;v+=2)n+=l[v]/10,u+=l[v+1]/10,c.lineTo(n,u);c.strokeStyle=d(m[1]);c.lineWidth=m[2]; c.lineCap=e(m[3]);c.lineJoin=f(m[4]);c.stroke();c.strokeStyle=d(k[1]);c.lineWidth=k[2];c.lineCap=e(k[3]);c.lineJoin=f(k[4]);c.stroke()}b.Xe=o},oe:function(a){a>>>=0;return"rgba("+(a>>24&255)+","+(a>>16&255)+","+(a>>8&255)+","+(a&255)/256+")"},Yw:function(a){return["butt","square","round"][a]},Zw:function(a){return["miter","bevel","round"][a]}});w.extend($a.prototype,{ye:function(){this.pa(this.B,this.z)},pa:function(a,b){this.B=a;this.z=b;this.B&&this.z&&(this.Uq(),this.kS(),this.hq(),this.Cq())},remove:function(){var a=this.B;this.z.removeChild(this.Va);a.removeEventListener("zoomend",this.Tk);a.removeEventListener("moving",this.CM);a.removeEventListener("moveend",this.xk);a.removeEventListener("resize",this.Ek)},Uq:function(){var a=this.B,b=a.D.devicePixelRatio,c=a.na().k.Nb,d=a.xb(),a=d.width,d=d.height;this.Wh={};this.Nb=c;this.wc=b; this.qE=a;this.pE=d;this.hC=a*b;this.gC=d*b},kS:function(){var a=this.B,b=this.z,c=document.createElement("canvas"),d=c.style;d.position="absolute";d.zIndex=5;d.left=-a.offsetX+"px";d.top=-a.offsetY+"px";d.width=this.qE+"px";d.height=this.pE+"px";c.setAttribute("width",this.hC);c.setAttribute("height",this.gC);b.appendChild(c);this.Va=c;this.Gh=c.getContext("2d");a=this.wc;1<a&&!c.lg&&(this.Gh.scale(a,a),c.lg=o)},hq:function(){function a(){b.Va.style.left=-c.offsetX+"px";b.Va.style.top=-c.offsetY+ "px"}var b=this,c=b.B,d=b.wc;b.Tk=function(c){b.Va.style.display=18>this.ea()?"none":"block";a();b.Cq(c)};b.CM=function(c){var d=(new Date).getTime();100>d-b.YL||(b.YL=d,a(),b.Cq(c))};b.xk=function(c){a();b.Cq(c)};b.Ek=function(e){var f=c.xb(),g=f.width,f=f.height,i=g*d,k=f*d;b.Va.style.width=g+"px";b.Va.style.height=f+"px";b.Va.setAttribute("width",i);b.Va.setAttribute("height",k);b.qE=g;b.pE=f;b.hC=i;b.gC=k;a();b.Cq(e)};c.addEventListener("zoomend",b.Tk);c.addEventListener("moving",b.CM);c.addEventListener("moveend", b.xk);c.addEventListener("resize",b.Ek)},Cq:function(a){var b=this.B,c=b.ea();if(!(18>c)){var d=b.ab.UK(),e=d[0],b=d[1],f=d[2],d=d[3],a=a?q:o,g;for(g in this.Wh)for(var i=e;i<f;i++)for(var k=b;k<d;k++)g==i+"_"+k+"_"+c&&(this.Wh[g].FH=o);for(g in this.Wh)this.Wh[g].FH?delete this.Wh[g].FH:(this.Wh[g]=p,delete this.Wh[g]);this.Gh.clearRect(0,0,this.hC,this.gC);for(i=e;i<f;i++)for(k=b;k<d;k++)(g=this.Wh[i+"_"+k+"_"+c])?this.Kn(g,i,k,c,a):this.kr(i,k,c,a)}},kr:function(a,b,c,d){var e=this,f=e.B,g=e.WU, i=(a+b)%g.length,k="x="+a+"&y="+b+"&z="+c,l=f.aa.replace(/^TANGRAM_/,"")+"building"+parseInt(a+""+b+""+c).toString(36),g=g[i]+"qt=hjpgvd&"+k+"&styles=pl&layers=bg&features=bd&f=mwebapp&v=001&udt=20130501&fn=BMap."+l,i=f.Ia(),m=new H(i.lng,i.lat),n=f.ea();z[l]=function(g){if(g=g.content){var i=f.Ia(),k=f.ea();if(!i.lb(m)||k!=n){delete z[l];return}if(g=window.HY(g))e.Kn(g,a,b,c,d),e.Wh[a+"_"+b+"_"+c]=g}delete z[l]};Qb(g)},Kn:function(a,b,c,d,e){e&&this.k.HK?this.PQ(a,b,c,d):this.UG(a,b,c,d,1)},PQ:function(a, b,c,d){var e=this;a.BP=new pb({Fc:50,duration:200,ta:function(f){e.UG(a,b,c,d,f)},finish:function(){a.BP=p}})},UG:function(a,b,c,d,e){var f=this.B,g=this.qE,i=this.pE,d=f.na().zc(d),f=f.kc,k=this.Nb,b=b*k-f.lng/d,c=(-1-c)*k+f.lat/d,d=this.Gh,f=a.length,k=0,l=window.Bb;d.save();for(d.translate(b+g/2,c+i/2);k<f;k++){var m=a[k],n=l[m[3]];if(4==n[0]){var u=m[7];window.VectorDrawUtils.LC(d,m[1],6*(m[2]*n[3])*e,90*((b+(u[0]+u[2])/2)/(g/2)),90*((c+(u[1]+u[3])/2)/(i/2)),"rgba(212,205,197,1)","rgba(235,233,228,1)", "rgba(170,170,170,1)",1)}}d.restore()}}); ');
